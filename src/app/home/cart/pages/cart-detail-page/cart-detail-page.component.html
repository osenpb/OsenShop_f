<!-- TÍTULO -->
<section class="py-10 text-center">
  <h1
    class="
      text-4xl md:text-5xl font-semibold
      text-neutral-900 dark:text-black
    "
  >
    Mi carrito
  </h1>

  <p class="mt-2 text-neutral-500">
    Revisa tus productos antes de pagar
  </p>
</section>

<!-- CONTENIDO -->
<section class="max-w-6xl mx-auto px-6 pb-16">

  @if (isLoading()) {

    <div class="text-center text-neutral-500">
      Cargando carrito...
    </div>

  } @else if (cartItems()) {

    @if (cartItems()!.length === 0) {

      <div class="text-center text-neutral-500">
        Tu carrito está vacío
      </div>

    } @else {

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- LISTA DE ITEMS -->
        <div class="lg:col-span-2 space-y-6">

          @for (item of cartItems(); track item.id) {

            <div
              class="
                flex gap-5 items-center
                bg-white dark:bg-neutral-900
                border border-neutral-200 dark:border-neutral-800
                rounded-2xl p-5
                hover:shadow-sm
                transition
              "
            >

              <!-- Imagen -->
              <div
                class="
                  w-24 h-24
                  rounded-xl overflow-hidden
                  bg-neutral-100 dark:bg-neutral-800
                "
              >
                <img
                  [src]="item.productResponse.imageUrl"
                  [alt]="item.productResponse.name"
                  class="w-full h-full object-cover"
                />
              </div>

              <!-- Info -->
              <div class="flex-1">
                <h3 class="font-medium text-neutral-900 dark:text-white">
                  {{ item.productResponse.name }}
                </h3>

                <p class="text-sm text-neutral-500">
                  {{ item.productResponse.category.name }}
                </p>

                <p class="mt-1 text-neutral-900 dark:text-white">
                  ${{ item.productResponse.price }}
                </p>
              </div>

              <!-- Cantidad -->
              <div class="text-center min-w-[80px]">
                <p class="text-xs text-neutral-500">Cantidad</p>
                <p class="font-medium text-neutral-900 dark:text-white">
                  {{ item.quantity }}
                </p>
              </div>

              <!-- Subtotal -->
              <div class="text-right min-w-[100px]">
                <p class="text-xs text-neutral-500">Subtotal</p>
                <p class="font-semibold text-neutral-900 dark:text-white">
                  ${{ item.productResponse.price * item.quantity }}
                </p>
              </div>

              <!-- Eliminar -->
              <div class="ml-2">
                <button
                  type="button"
                  (click)="removeFromCart(item.id)"
                  class="
                    p-2
                    text-neutral-400 hover:text-red-600
                    rounded-lg
                    transition
                  "
                >
                  ✕
                </button>
              </div>

            </div>
          }

        </div>

        <!-- RESUMEN / PAGO -->
        <aside
          class="
            h-fit
            sticky top-24
            bg-white dark:bg-neutral-900
            border border-neutral-200 dark:border-neutral-800
            rounded-2xl
            p-6
            space-y-6
          "
        >

          <h2
            class="
              text-lg font-medium
              text-neutral-900 dark:text-white
            "
          >
            Resumen del pedido
          </h2>

          <div class="flex justify-between text-sm text-neutral-500">
            <span>Subtotal</span>
            <span>${{ total() }}</span>
          </div>

          <div
            class="
              flex justify-between
              text-lg font-semibold
              text-neutral-900 dark:text-white
              pt-4
              border-t border-neutral-200 dark:border-neutral-800
            "
          >
            <span>Total</span>
            <span>${{ total() }}</span>
          </div>

          <button
            routerLink="/home/checkout"
            type="button"
            class="
              w-full
              py-3
              rounded-xl
              text-white font-medium
              bg-black dark:bg-white
              dark:text-black
              hover:opacity-90
              transition
            "
          >
            Pagar ahora
          </button>

          <p class="text-xs text-neutral-500 text-center">
            Paga seguro
          </p>

        </aside>

      </div>
    }

  } @else {

    <div class="text-center text-red-500">
      Ocurrió un error al cargar el carrito
    </div>

  }

</section>
